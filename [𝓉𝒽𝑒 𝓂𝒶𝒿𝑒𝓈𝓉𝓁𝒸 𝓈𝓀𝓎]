local WindUI

do
    local ok, result = pcall(function()
        return require("./src/Init")
    end)
    
    if ok then
        WindUI = result
    else 
        WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/Footagesus/WindUI/main/dist/main.lua"))()
    end
end

function createPopup()
    return WindUI:Popup({
        Title = "Welcome to the WindUI!",
        Icon = "bird",
        Content = "‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏™‡∏Ñ‡∏•‡∏¥‡∏õ‡πÑ‡∏°‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÉ‡∏ä‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö",
        Buttons = {
            {
                Title = "‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß",
                Icon = "bird",
            },
        }
    })
end



-- */  Window  /* --
local Window = WindUI:CreateWindow({
    Title = "SLEEP HUB PRO MAX",
    Author = "by .ftgs ‚Ä¢ Footagesus",
    Folder = "ftgshub",
    Icon = "rbxassetid://121030902371363",
    IconSize = 22*2,
    NewElements = true,
    --Size = UDim2.fromOffset(700,700),
    
    HideSearchBar = false,
    
    OpenButton = {
        Title = " SLEEP HIB UI", -- can be changed
        CornerRadius = UDim.new(1,0), -- fully rounded
        StrokeThickness = 3, -- removing outline
        Enabled = true, -- enable or disable openbutton
        Draggable = true,
        OnlyMobile = false,
        
        Color = ColorSequence.new( -- gradient
            Color3.fromHex("#30FF6A"), 
            Color3.fromHex("#e7ff2f")
        )
    },
})










local Tab = Window:Tab({
    Title = "‡∏´‡∏ô‡∏±‡∏≤‡∏´‡∏•‡∏±‡∏Å",
    Icon = "bird", -- optional
    Locked = false,
})









local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

local EnemyFolder = workspace:WaitForChild("Live")
    :WaitForChild("Entities")
    :WaitForChild("Enemy")
    :WaitForChild("Client")

local RequestSwing = ReplicatedStorage
    :WaitForChild("SharedModules")
    :WaitForChild("Networking")
    :WaitForChild("Network")
    :WaitForChild("RequestSwing")

local running = false
local connection

-- üîç ‡∏´‡∏≤ Enemy ‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
local function getClosestEnemy()
    local closestEnemy = nil
    local closestDistance = math.huge

    for _, enemy in pairs(EnemyFolder:GetChildren()) do
        if enemy:IsA("Model") and enemy:FindFirstChild("HumanoidRootPart") then
            local distance = (enemy.HumanoidRootPart.Position - hrp.Position).Magnitude
            if distance < closestDistance then
                closestDistance = distance
                closestEnemy = enemy
            end
        end
    end

    return closestEnemy
end

-- üéØ Toggle
local Toggle = Tab:Toggle({
    Title = "‡∏ï‡∏µ‡∏≠‡∏≠‡πÇ‡∏ï‡πâ",
    Icon = "bird",
    Type = "Checkbox",
    Value = false,

    Callback = function(state)
        running = state

        if running then
            connection = RunService.Heartbeat:Connect(function()
                task.wait(0.01)

                local enemy = getClosestEnemy()
                if enemy then
                    -- üß© ‡∏î‡∏∂‡∏á ID (‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡πÄ‡∏Å‡∏°)
                    local enemyId =
                        enemy:GetAttribute("Id")
                        or enemy:GetAttribute("EntityId")
                        or tonumber(enemy.Name)

                    if enemyId then
                        local args = {
                            {
                                enemyId
                            }
                        }

                        pcall(function()
                            RequestSwing:InvokeServer(unpack(args))
                        end)
                    end
                end
            end)
        else
            if connection then
                connection:Disconnect()
                connection = nil
            end
        end
    end
})










local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

local running = false
local connection

local function startPull()
    if connection then return end

    connection = RunService.Heartbeat:Connect(function()
        if not running then return end

        local char = player.Character
        local hrp = char and char:FindFirstChild("HumanoidRootPart")
        if not hrp then return end

        local rewardFolder = workspace:FindFirstChild("Live")
        rewardFolder = rewardFolder and rewardFolder:FindFirstChild("RewardDrops")
        if not rewardFolder then return end

        for _, item in ipairs(rewardFolder:GetChildren()) do
            if item:IsA("BasePart") then
                item.CFrame = hrp.CFrame
            elseif item:IsA("Model") and item.PrimaryPart then
                item:SetPrimaryPartCFrame(hrp.CFrame)
            end
        end
    end)
end

local function stopPull()
    if connection then
        connection:Disconnect()
        connection = nil
    end
end

local Toggle = Tab:Toggle({
    Title = "‡∏≠‡∏≠‡πÇ‡∏ï‡πâ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏•‡πÄ‡∏ß‡∏•",
    Icon = "bird",
    Type = "Checkbox",
    Value = false,
    Callback = function(state)
        running = state
        if state then
            startPull()
        else
            stopPull()
        end
    end
})











local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

local AutoPickup = false
local LoopThread

local function FirePrompt(prompt)
    pcall(function()
        fireproximityprompt(prompt)
    end)
end

local function StartLoop()
    LoopThread = task.spawn(function()
        while AutoPickup do
            task.wait(0.01)

            local char = player.Character
            local hrp = char and char:FindFirstChild("HumanoidRootPart")
            if not hrp then continue end

            local drops = workspace:FindFirstChild("Live")
            if not drops then continue end
            drops = drops:FindFirstChild("ItemDrops")
            if not drops then continue end

            for _, item in ipairs(drops:GetChildren()) do
                task.spawn(function()
                    local part =
                        item:IsA("Model") and item.PrimaryPart
                        or item:IsA("BasePart") and item

                    if part then
                        -- ‡∏î‡∏∂‡∏á‡∏Ç‡∏≠‡∏á‡∏°‡∏≤‡∏´‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô
                        part.CFrame = hrp.CFrame * CFrame.new(0, 0, -3)
                    end

                    -- ‡∏´‡∏≤ ProximityPrompt
                    for _, v in ipairs(item:GetDescendants()) do
                        if v:IsA("ProximityPrompt") then
                            FirePrompt(v)
                        end
                    end
                end)
            end
        end
    end)
end

local Toggle = Tab:Toggle({
    Title = "‡∏≠‡∏≠‡πÇ‡∏ï‡πâ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏≠‡∏á",
    Icon = "bird",
    Type = "Checkbox",
    Value = false,
    Callback = function(state)
        AutoPickup = state
        if state then
            StartLoop()
        end
    end
})










local flyScriptLoaded = false
local flyScript

local Toggle = Tab:Toggle({
    Title = "‡∏ö‡∏¥‡∏ô",
    Icon = "bird",
    Type = "Checkbox",
    Value = false, -- default value
    Callback = function(state)
        if state then
            -- ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå ‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î
            if not flyScriptLoaded then
                flyScript = loadstring(game:HttpGet("https://raw.githubusercontent.com/XNEOFF/FlyGuiV3/main/FlyGuiV3.txt"))()
                flyScriptLoaded = true
            end
        else
            -- ‡∏ñ‡πâ‡∏≤ FlyGuiV3 ‡∏°‡∏µ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏¥‡∏î ‡∏•‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏õ‡∏¥‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
            if flyScriptLoaded and flyScript and flyScript.Stop then
                flyScript:Stop()
            end
        end
    end
})
